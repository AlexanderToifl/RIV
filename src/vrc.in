# Variables, Random atoms and Changing velocity of individual atoms (VRC)

units 		metal

variable temp_lower equal 300.
variable temp_upper equal 400.

variable unit_cell equal 4

boundary 	p p p
atom_style	atomic

neighbor 		0.3 bin
neigh_modify	delay 1

lattice			diamond 5.432

region			base block 0 ${unit_cell} 0 ${unit_cell} 0 ${unit_cell} units lattice
create_box		1 base
create_atoms	1 region base

#use Stillinger - Weber Potential to generate a-Si

mass			1 28.09
pair_style		sw
pair_coeff		* * Si.sw Si

#Melting Step

fix 			1 all nve
fix 			2 all temp/berendsen ${temp_lower} ${temp_upper} 0.1
#fix 			5 all press/berendsen iso 1.0 40000.0 1000.0

reset_timestep 0
timestep		0.001

dump			1 all atom 100 dump.vrc1

thermo_style custom step lx ly lz press pxx pyy pzz pe atoms temp 
thermo			100
thermo_modify	lost ignore flush yes

run 5000
unfix 2


variable tmp equal "lx"
variable tmp1 equal "temp"

variable L0 equal ${tmp}
variable T0 equal ${tmp1}
print "Initial Length, L0: ${L0}"
print "Temperature after Melting Step, T0: ${T0}"
print "Temperature T: ${tmp1}"



#Equilibration

dump			2 all atom 100 dump.vrc2
run 4000

#choose random atom 
variable tmp2 equal "atoms"
variable rn_id equal floor(random(0,${tmp2},30491))
print "Random id: ${rn_id}"

#define group that contains the chosen atom
group matoms id ${rn_id}

velocity matoms set 10 10 10
#velocity matoms scale 100 <-- does not work

dump			6 all atom 100 dump.vrc3

run 4000
